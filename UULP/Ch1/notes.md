# 操作系统职责
- 操作系统管理资源，将不同设备和不同资源连接起来。
- 它也是程序，只是有些特殊。
# UNIX主要结构
- 内存空间：存放程序和数据。
	- 分为系统空间和用户空间
	- 系统空间：存放操作系统的内存空间
	- 用户空间：存放应用程序的内存空间
- 内核：操作系统的别名
- 用户通过终端连接到系统，文件存放于磁盘，各种设备被内核直接管理;用户程序通过内核访问设备;用户通过网络接入系统
# 现在的情况
- 程序访问设备需要通过内核
- 程序要从键盘获得数据，向内核发出请求，
- 若在显示器显示结果，也要通过内核
- 总结：程序中对所有设备的操作都要通过内核
# 系统编程
## 概念
- 编普通程序：可以看作是直连键盘，显示器等设备。
- 现在：
  - 必须对系统的结构和工作方式了解
  - 内核提供哪些服务
  - 系统有哪些资源，设备，不同的资源怎么操作等
## 资源
### 处理器
### I/O
- 程序IO数据，终端IO数据等都必须流经内核，
- 优点：
  - 正确性
  - 有效性
  - 安全性
### 进程管理
- 内核的服务有新建进程，终止，进程调度等。
### 内存
- 程序被装载到内存中才可运行
- 内核职责之一：内存管理
  - 分配内存
  - 回收内存
  - 保证内存不被其他进程非法访问
### 设备
- 各种外设
- 内核能屏蔽这种差异，对设备操作方式简单统一
### 计时器
### 进程间通信
### 网络
  
### 理解系统编程的方法
#### 1.分析程序
分析现有程序，了解功能和实现原理。
#### 2.学习系统调用
看程序有哪些系统调用，每个调用的功能和方法。
#### 3.编程实现

## 命令
### 文件操作
#### 查看
- cat：列出所有内容
- more：内容过多的文件比较合适
- less 与more类似
- pg
#### 删除
删除不提供恢复，原因：Unix是一个多用户操作系统，当文件删除，可能他所占用的空间立马分配给其他用户的文件。
#### 文件许可权限
- 每个文件都有文件所有者和3组许可权限
- 用户也被分三组，user,group[与文件所有者同组],other

# 从系统角度看Unix
## 桥牌例子
- 通信
- 协作
- 网络访问
## 计算器
- bc
- dc：用逆波兰表达式（后缀表达式），
- 实现：
  - bc是dc的预处理器，
  - 通过bc将用户的输入转换成逆波兰,
  - 通过一个管道的通信程序交给dc，
  - dc计算表达式的值，返给bc,
  - bc再将结果显示在显示器。
- 特点：很多协作。unix系统编程很多场合，就是要解决好这些独立程序的连接和协作方式的问题
# 实现more命令
## 三种用法
```
$ more filename
$ command | more
$ more < filename
```
- 第一：显示文件filename的内容
- 第二：将command命令的输出分页显示
- 第三：标准输入获取分页内容
## 实现
### `/dev/tty`
- 这是键盘和显示器的设备描述文件
-	向这个文件
	- 读==从键盘获取输入
	- 写==显示在用户屏幕上
### more v2的不足
- 用户按空格或"q",还得按回车。
- 输入的字符会回显
### 思考
- 对输入的进一步处理，需要通过控制和调整终端参数
- 有待改进
	- 怎么知道显示的百分比
	- 反白显示文字
	- 确定每页行数





